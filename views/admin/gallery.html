<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ì–∞–ª–µ—Ä–µ—è ‚Äî –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/admin.css">
    <link rel="icon" type="image/png" href="/images/logo.png">
    <style>
        .gallery-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }

        .gallery-tab {
            padding: 12px 24px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            color: #6b7280;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
            transition: all 0.3s;
        }

        .gallery-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: 600;
        }

        .photo-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }

        .photo-card {
            position: relative;
            aspect-ratio: 1;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #e5e7eb;
        }

        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .photo-actions {
            position: absolute;
            top: 8px;
            right: 8px;
            display: flex;
            gap: 4px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .photo-card:hover .photo-actions {
            opacity: 1;
        }

        .photo-actions button {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: transform 0.2s;
        }

        .photo-actions button:hover {
            transform: scale(1.1);
        }

        .upload-zone {
            border: 2px dashed #cbd5e1;
            border-radius: 12px;
            padding: 40px 20px;
            text-align: center;
            background: #f9fafb;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-zone:hover {
            border-color: #667eea;
            background: #f3f4ff;
        }

        .upload-zone.dragover {
            border-color: #667eea;
            background: #e0e7ff;
        }
    </style>
</head>

<body>
    <nav class="navbar">
        <div class="navbar-container container">
            <a href="/" class="logo">21-<span>IDUM</span></a>
            <ul class="nav-links">
                <li><a href="/">–ù–∞ —Å–∞–π—Ç</a></li>
            </ul>
        </div>
    </nav>

    <section class="admin-wrap">
        <div class="container">
            <div class="admin-shell">
                <aside class="admin-sidebar">
                    <div class="topbar">
                        <strong id="userLabel">–ê–¥–º–∏–Ω</strong>
                        <button id="logoutBtn" class="btn btn-sm btn-danger">–í—ã–π—Ç–∏</button>
                    </div>
                    <ul class="nav-list" id="navMenuAdmin">
                        <li><a href="/admin">–î–∞—à–±–æ—Ä–¥</a></li>
                        <li><a href="/admin/news">–ù–æ–≤–æ—Å—Ç–∏</a></li>
                        <li><a href="/admin/announcements">–û–±—ä—è–≤–ª–µ–Ω–∏—è</a></li>
                        <li><a href="/admin/faq">FAQ</a></li>
                        <li><a href="/admin/events">–°–æ–±—ã—Ç–∏—è</a></li>
                        <li><a href="/admin/teachers">–£—á–∏—Ç–µ–ª—è</a></li>
                        <li><a href="/admin/reviews">–û—Ç–∑—ã–≤—ã</a></li>
                        <li><a href="/admin/gallery" class="active">–ì–∞–ª–µ—Ä–µ—è</a></li>
                        <li id="scheduleMenuAdmin"><a href="/admin/schedule">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</a></li>
                        <li id="usersMenuAdmin"><a href="/admin/users">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a></li>
                        <li id="auditMenuAdmin"><a href="/admin/audit">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—Ö–æ–¥—ã</a></li>
                    </ul>
                </aside>
                <main class="admin-content">
                    <div class="topbar">
                        <div>
                            <h1 style="margin:0 0 4px; font-size:22px">–ì–∞–ª–µ—Ä–µ—è</h1>
                            <p class="muted" style="margin:0">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ç–æ–∞–ª—å–±–æ–º–∞–º–∏</p>
                        </div>
                        <button id="createAlbumBtn" class="btn">+ –°–æ–∑–¥–∞—Ç—å –∞–ª—å–±–æ–º</button>
                    </div>

                    <!-- Albums Tab -->
                    <div id="albumsTable">
                        <div class="empty">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                    </div>

                    <!-- Photos Tab -->
                    <div id="photosView" style="display: none;">
                        <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 20px;">
                            <button class="btn btn-secondary" id="backToAlbumsBtn">‚Üê –ù–∞–∑–∞–¥ –∫ –∞–ª—å–±–æ–º–∞–º</button>
                            <div style="flex: 1;">
                                <h2 id="currentAlbumTitle" style="margin: 0 0 4px; font-size: 20px;"></h2>
                                <p id="currentAlbumDesc" class="muted" style="margin: 0;"></p>
                            </div>
                            <button class="btn" id="addPhotoBtn">+ –î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</button>
                        </div>
                        <div id="photosGrid" class="photo-grid"></div>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- Create/Edit Album Modal -->
    <div id="albumModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <h2 id="albumModalTitle">–°–æ–∑–¥–∞—Ç—å –∞–ª—å–±–æ–º</h2>
            <div id="albumErrorBox" class="error"></div>
            <form id="albumForm">
                <div class="form-tabs">
                    <div class="form-tab active" data-lang="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</div>
                    <div class="form-tab" data-lang="uz">üá∫üáø O'zbekcha</div>
                </div>

                <div class="lang-content active" data-lang="ru">
                    <div class="form-group">
                        <label for="title_ru">–ù–∞–∑–≤–∞–Ω–∏–µ –∞–ª—å–±–æ–º–∞ *</label>
                        <input type="text" id="title_ru" required>
                    </div>
                    <div class="form-group">
                        <label for="description_ru">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="description_ru" rows="3"></textarea>
                    </div>
                </div>

                <div class="lang-content" data-lang="uz">
                    <div class="form-group">
                        <label for="title_uz">Albom nomi</label>
                        <input type="text" id="title_uz">
                    </div>
                    <div class="form-group">
                        <label for="description_uz">Tavsif</label>
                        <textarea id="description_uz" rows="3"></textarea>
                    </div>
                </div>

                <div class="form-group">
                    <label for="coverPhotoFile">–û–±–ª–æ–∂–∫–∞ –∞–ª—å–±–æ–º–∞</label>
                    <input type="file" id="coverPhotoFile" name="coverImage" accept="image/*" style="display:none"
                        data-max-size="5242880">
                    <div class="file-drop-area" data-filedrop="coverPhotoFile">
                        <div class="file-instructions">
                            –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ –æ–±–ª–æ–∂–∫—É —Å—é–¥–∞ –∏–ª–∏ <strong>–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–ª–µ</strong>
                        </div>
                    </div>
                    <div class="file-name" data-filedrop-name="coverPhotoFile" style="margin-top:6px">–§–∞–π–ª –Ω–µ –≤—ã–±—Ä–∞–Ω
                    </div>
                    <div class="text-sm muted" style="margin-top:6px">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: 800x600. –ú–∞–∫—Å: 5MB. –§–æ—Ä–º–∞—Ç—ã:
                        JPEG, PNG, WebP.</div>
                    <div id="coverPreview" style="margin-top:10px; display:none;">
                        <img id="coverPreviewImg" src=""
                            style="max-width:200px; border-radius:8px; border:1px solid #e5e7eb;">
                        <button type="button" id="removeCover" class="btn btn-secondary"
                            style="margin-left:10px; padding:6px 12px;">–£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                    <input type="hidden" id="coverPhoto" name="coverPhoto">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="status">–°—Ç–∞—Ç—É—Å</label>
                        <select id="status">
                            <option value="draft">–ß–µ—Ä–Ω–æ–≤–∏–∫</option>
                            <option value="published">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ</option>
                        </select>
                    </div>

                </div>

                <div class="actions">
                    <button type="submit" class="btn" id="saveAlbumBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" id="cancelAlbumBtn">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Photo Modal -->
    <div id="photoModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 600px;">
            <h2>–î–æ–±–∞–≤–∏—Ç—å —Ñ–æ—Ç–æ</h2>
            <div id="photoErrorBox" class="error"></div>
            <form id="photoForm">
                <div class="form-group">
                    <label for="photoFiles">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–æ—Ç–æ *</label>
                    <input type="file" id="photoFiles" name="images" accept="image/*" multiple required
                        style="display:none" data-max-size="10485760">
                    <div class="file-drop-area" data-filedrop="photoFiles">
                        <div class="file-instructions">
                            –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–æ—Ç–æ —Å—é–¥–∞ –∏–ª–∏ <strong>–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –ø–æ–ª–µ</strong>
                        </div>
                    </div>
                    <div class="file-name" data-filedrop-name="photoFiles" style="margin-top:6px">–§–∞–π–ª—ã –Ω–µ –≤—ã–±—Ä–∞–Ω—ã</div>
                    <div class="text-sm muted" style="margin-top:6px">–ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–æ—Ç–æ. –ú–∞–∫—Å: 10MB –Ω–∞ —Ñ–æ—Ç–æ.
                        –§–æ—Ä–º–∞—Ç—ã: JPEG, PNG, WebP.</div>
                    <div id="photosPreviews"
                        style="margin-top:10px; display:none; display:grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap:8px;">
                    </div>
                </div>

                <div class="form-tabs">
                    <div class="form-tab active" data-lang="ru">üá∑üá∫ –†—É—Å—Å–∫–∏–π</div>
                    <div class="form-tab" data-lang="uz">üá∫üáø O'zbekcha</div>
                </div>

                <div class="lang-content active" data-lang="ru">
                    <div class="form-group">
                        <label for="caption_ru">–ü–æ–¥–ø–∏—Å—å (–¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ç–æ)</label>
                        <input type="text" id="caption_ru">
                    </div>
                </div>

                <div class="lang-content" data-lang="uz">
                    <div class="form-group">
                        <label for="caption_uz">Izoh (barcha fotolar uchun)</label>
                        <input type="text" id="caption_uz">
                    </div>
                </div>

                <div class="actions">
                    <button type="submit" class="btn" id="savePhotoBtn">–î–æ–±–∞–≤–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" id="cancelPhotoBtn">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <script src="/admin-nav.js"></script>
    <script src="/csrf-helper.js"></script>
    <script src="/admin-filedrop.js"></script>
    <script src="/admin-gallery.js"></script>
    <script>
        // Initialize file drops
        document.addEventListener('DOMContentLoaded', () => {
            if (window.initFileDrop) {
                initFileDrop('photoFiles');
                initFileDrop('coverPhotoFile');
            }
        });
    </script>
</body>

</html>